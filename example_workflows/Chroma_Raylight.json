{
  "id": "b2d37916-fab5-425f-850d-7a64886e4d54",
  "revision": 0,
  "last_node_id": 767,
  "last_link_id": 1392,
  "nodes": [
    {
      "id": 737,
      "type": "EmptySD3LatentImage",
      "pos": [
        -2250.319580078125,
        1542.5584716796875
      ],
      "size": [
        370,
        106
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            1387
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "EmptySD3LatentImage",
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        1024,
        1024,
        1
      ],
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 741,
      "type": "T5TokenizerOptions",
      "pos": [
        -1799.0684814453125,
        834.6585083007812
      ],
      "size": [
        210,
        82
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 1342
        }
      ],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [
            1356,
            1359
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "T5TokenizerOptions",
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        0,
        0
      ]
    },
    {
      "id": 742,
      "type": "Note",
      "pos": [
        -1809.0684814453125,
        964.6587524414062
      ],
      "size": [
        230,
        88
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Optional Padding",
      "properties": {},
      "widgets_values": [
        "min_padding 1 is the official way. setting it to 0 works too. "
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 748,
      "type": "CLIPTextEncode",
      "pos": [
        -1543.958984375,
        580.64794921875
      ],
      "size": [
        407.2727355957031,
        202.72727966308594
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 1356
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "links": [
            1389
          ]
        }
      ],
      "title": "CLIP Text Encode (Positive Prompt)",
      "properties": {
        "Node name for S&R": "CLIPTextEncode",
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        "This is a nature documentary close-up photograph of the right side of the face of a crow. The photograph is centered on it's highly detailed and speckled eye surrounded by intricately detailed fur. Overlaid at the center of the image is a title text that says \"Raylight CHROMA1-HD\" in a large white 3D letters. Amateur photography. Unfiltered. Real life. Natural light. Subtle shadows. "
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 298,
      "type": "VAEDecode",
      "pos": [
        -1410.96875,
        1164.3994140625
      ],
      "size": [
        140,
        46
      ],
      "flags": {
        "collapsed": false
      },
      "order": 18,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 1388
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 1252
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            1341
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "VAEDecode",
        "cnr_id": "comfy-core",
        "ver": "0.3.27",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": []
    },
    {
      "id": 749,
      "type": "CLIPTextEncode",
      "pos": [
        -1539.9658203125,
        831.9789428710938
      ],
      "size": [
        400,
        200
      ],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 1359
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "links": [
            1390
          ]
        }
      ],
      "title": "CLIP Text Encode (Negative Prompt)",
      "properties": {
        "Node name for S&R": "CLIPTextEncode",
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        "This low quality greyscale unfinished sketch is inaccurate and flawed. The image is very blurred and lacks detail with excessive chromatic aberrations and artifacts. The image is overly saturated with excessive bloom. It has a toony aesthetic with bold outlines and flat colors. "
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 739,
      "type": "Note",
      "pos": [
        -1828.3857421875,
        674.5184326171875
      ],
      "size": [
        260,
        90
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Optional Flow Shift",
      "properties": {},
      "widgets_values": [
        "Flow Shift node set to 1.0 represents intended shift by the creator of the Chroma model and will produce greater detail. "
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 753,
      "type": "RayModelSamplingAuraFlow",
      "pos": [
        -1794.863525390625,
        1169.5511474609375
      ],
      "size": [
        280.4234313964844,
        58
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "link": 1373
        }
      ],
      "outputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "links": [
            1386
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayModelSamplingAuraFlow"
      },
      "widgets_values": [
        1
      ]
    },
    {
      "id": 752,
      "type": "RayUNETLoader",
      "pos": [
        -2260.8271992187506,
        1041.1252148437488
      ],
      "size": [
        270,
        102
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "ray_actors_init",
          "type": "RAY_ACTORS_INIT",
          "link": 1372
        },
        {
          "name": "lora",
          "shape": 7,
          "type": "RAY_LORA",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "links": [
            1373
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayUNETLoader"
      },
      "widgets_values": [
        "chroma.safetensors",
        "default"
      ]
    },
    {
      "id": 733,
      "type": "CLIPLoader",
      "pos": [
        -2260.4399999999996,
        1206.11674609375
      ],
      "size": [
        370,
        110
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [
            1342
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "CLIPLoader",
        "cnr_id": "comfy-core",
        "ver": "0.3.57",
        "models": [
          {
            "name": "t5xxl_fp8_e4m3fn_scaled.safetensors",
            "url": "https://huggingface.co/comfyanonymous/flux_text_encoders/resolve/main/t5xxl_fp8_e4m3fn_scaled.safetensors",
            "directory": "text_encoders"
          }
        ],
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        "t5xxl.safetensors",
        "chroma",
        "default"
      ]
    },
    {
      "id": 710,
      "type": "VAELoader",
      "pos": [
        -2271.54931640625,
        1368.964697265625
      ],
      "size": [
        370,
        60
      ],
      "flags": {
        "collapsed": false
      },
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "links": [
            1252
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "VAELoader",
        "cnr_id": "comfy-core",
        "ver": "0.3.27",
        "models": [
          {
            "name": "ae.safetensors",
            "url": "https://huggingface.co/Comfy-Org/Lumina_Image_2.0_Repackaged/resolve/main/split_files/vae/ae.safetensors",
            "directory": "vae"
          }
        ],
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        "ae.safetensors"
      ]
    },
    {
      "id": 763,
      "type": "MarkdownNote",
      "pos": [
        -2716.5543462836777,
        522.532558742641
      ],
      "size": [
        403.4657275075731,
        1054.769169761564
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Introduction",
      "properties": {},
      "widgets_values": [
        "## Raylight Overview\n\nAs the name implies, **Raylight** uses Ray workers, called *Actors*.  \nEach worker is its own Python process. While this allows splitting across multiple VRAMs,  \nit does increase overall RAM usage.  \n\nThat said, RAM is generally much cheaper than VRAM, so this trade-off is acceptable in most cases.  \n\n---\n\n## More info: \n\n### [Raylight on GitHub](https://github.com/komikndr/raylight)\n### [Raylight guide on Youtube](https://youtu.be/KQxrkJAV4eI?si=hAFY1rKD6Y2UHXqY)\n\n\n## Supported Models\n\n| Model               | USP | FSDP | CFG |\n|---------------------|-----|------|-----|\n| Wan2.X 14B T2V      | ✅  | ✅   | ✅  |\n| Wan2.X 14B I2V      | ✅  | ✅   | ✅  |\n| Wan2.1 1.3B T2V     | ✅  | ✅   | ✅  |\n| Wan2.2 5B TI2V      | ✅  | ✅   | ✅  |\n| Flux Dev            | ✅  | ✅   | ❌  |\n| Flux Konteks        | ✅  | ✅   | ❌  |\n| Flux Krea           | ✅  | ✅   | ❌  |\n| Flux 2              | ✅  | ✅   | ❌  |\n| Chroma              | ✅  | ✅   | ✅  |\n| Chroma Radiance     | ✅  | ✅   | ✅  |\n| Qwen Image/Edit     | ✅  | ✅   | ✅  |\n| Z Image             | ✅  | ✅   | ✅  |\n| Lumina 2            | ✅  | ✅   | ✅  |\n| Hunyuan Video       | ✅  | ❌   | ❌  |\n| Hunyuan 1.5         | ✅  | ❌   | ❌  |\n| SD1.5 (UNet)        | ❌  | ❌   | ✅  |\n| SDXL (UNet)         | ❌  | ❌   | ✅  |\n\n**Legend:**\n- ✅ = Supported  \n- ❌ = Not supported  \n\n**Notes:**\n- Non standard Wan variant (Phantom, S2V, etc...) is not tested\n\n## Scaled vs Non-Scaled Models\n\n| Model       | USP | FSDP |\n|-------------|-----|------|\n| Non-Scaled  | ✅  | ✅   |\n| Scaled      | ✅  | ⚠️ |\n\n**Notes:**\n- Scaled models use multiple dtypes inside their transformer blocks: typically **FP32** for scale, **FP16** for bias, and **FP8** for weights.\n- Only Ada Lovelace and newer GPUs support **FP8 scaled FSDP2**.\n\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 764,
      "type": "Note",
      "pos": [
        -2293.3773445710985,
        288.2712557910764
      ],
      "size": [
        221.074128638272,
        189.35890875820826
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Rule of thumb",
      "properties": {},
      "widgets_values": [
        "Just jack up more ulysses per number of GPUs, and set ring only 1.\n\nNo need FSDP if all of your model can be fitted into individual card. Especially image model who has low sequence length.\n\nFor SDXL and SD1.5 only CFG parallel"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 765,
      "type": "Note",
      "pos": [
        -2061.430077564321,
        291.1565288152337
      ],
      "size": [
        210,
        178.59762243597055
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Glosarry",
      "properties": {},
      "widgets_values": [
        "rank = id assigned to the GPU\nworld_size = number of GPUs\n\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 762,
      "type": "MarkdownNote",
      "pos": [
        -2708.222285221882,
        294.4441556740657
      ],
      "size": [
        385.26349810726197,
        184.87935303020652
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {},
      "widgets_values": [
        "\nRaylight uses **FSDP2** to shard the model across GPUs.\n\nIn rare cases, a memory leak may occur when switching from one LoRA to another while using FSDP. However, in most tests this issue does not appear, even with the same Docker setup....\n\nIf memory leak cases continue to grow, I will force a reinitialization of the Ray worker.\n\nIn the meantime, if you encounter this issue, please restart Comfy.\nOpen Issue on [Raylight Issue](https://github.com/komikndr/raylight/issues)\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 751,
      "type": "RayInitializer",
      "pos": [
        -2276.787353515625,
        578.0352783203125
      ],
      "size": [
        291.400390625,
        274
      ],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "ray_actors_init",
          "type": "RAY_ACTORS_INIT",
          "links": [
            1372
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayInitializer"
      },
      "widgets_values": [
        "local",
        "default",
        2,
        2,
        1,
        true,
        false,
        false,
        false,
        "TORCH"
      ]
    },
    {
      "id": 740,
      "type": "SaveImage",
      "pos": [
        -846.3494287109374,
        559.9450854492187
      ],
      "size": [
        539.2999877929688,
        1114.699951171875
      ],
      "flags": {},
      "order": 19,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 1341
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "SaveImage",
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "enableTabs": false,
        "tabWidth": 65,
        "tabXOffset": 10,
        "hasSecondTab": false,
        "secondTabText": "Send Back",
        "secondTabOffset": 80,
        "secondTabWidth": 65
      },
      "widgets_values": [
        "ComfyUI"
      ]
    },
    {
      "id": 767,
      "type": "easy cleanGpuUsed",
      "pos": [
        -1111.247346283676,
        890.8512557910768
      ],
      "size": [
        157.3892578125,
        26
      ],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "anything",
          "type": "*",
          "link": 1390
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "*",
          "links": [
            1391
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "easy cleanGpuUsed"
      },
      "widgets_values": []
    },
    {
      "id": 766,
      "type": "easy cleanGpuUsed",
      "pos": [
        -1102.7773462836744,
        656.1112557910761
      ],
      "size": [
        157.3892578125,
        26
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "anything",
          "type": "*",
          "link": 1389
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "*",
          "links": [
            1392
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "easy cleanGpuUsed"
      },
      "widgets_values": []
    },
    {
      "id": 754,
      "type": "XFuserKSamplerAdvanced",
      "pos": [
        -1782.083256835937,
        1275.6046875000002
      ],
      "size": [
        312.7340393066406,
        377.9230041503906
      ],
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "link": 1386
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 1392
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 1391
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 1387
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            1388
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "XFuserKSamplerAdvanced"
      },
      "widgets_values": [
        "enable",
        121381635473070,
        "randomize",
        26,
        3.5,
        "euler",
        "simple",
        0,
        10000,
        "disable"
      ]
    }
  ],
  "links": [
    [
      1252,
      710,
      0,
      298,
      1,
      "VAE"
    ],
    [
      1341,
      298,
      0,
      740,
      0,
      "IMAGE"
    ],
    [
      1342,
      733,
      0,
      741,
      0,
      "CLIP"
    ],
    [
      1356,
      741,
      0,
      748,
      0,
      "CLIP"
    ],
    [
      1359,
      741,
      0,
      749,
      0,
      "CLIP"
    ],
    [
      1372,
      751,
      0,
      752,
      0,
      "RAY_ACTORS_INIT"
    ],
    [
      1373,
      752,
      0,
      753,
      0,
      "RAY_ACTORS"
    ],
    [
      1386,
      753,
      0,
      754,
      0,
      "RAY_ACTORS"
    ],
    [
      1387,
      737,
      0,
      754,
      3,
      "LATENT"
    ],
    [
      1388,
      754,
      0,
      298,
      0,
      "LATENT"
    ],
    [
      1389,
      748,
      0,
      766,
      0,
      "*"
    ],
    [
      1390,
      749,
      0,
      767,
      0,
      "*"
    ],
    [
      1391,
      767,
      0,
      754,
      2,
      "CONDITIONING"
    ],
    [
      1392,
      766,
      0,
      754,
      1,
      "CONDITIONING"
    ]
  ],
  "groups": [
    {
      "id": 4,
      "title": "Sampler Settings",
      "bounding": [
        -1850,
        1080,
        730,
        589.3519897460938
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 5,
      "title": "Step 1: Load models",
      "bounding": [
        -2286.370146484375,
        952.3098745117194,
        416.5590134277345,
        491.7670068359374
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 6,
      "title": "Optional",
      "bounding": [
        -1849.0684814453125,
        504.65850830078125,
        290,
        560
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 7,
      "title": "Step 2: Image Size",
      "bounding": [
        -2290.319580078125,
        1452.5584716796875,
        418.7040100097656,
        216.0070037841797
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 8,
      "title": "Step 3: Prompt",
      "bounding": [
        -1543.958984375,
        510.64794921875,
        628.1200000000001,
        557.2600000000002
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    },
    {
      "id": 9,
      "title": "Ray Actor Initializer",
      "bounding": [
        -2286.787353515625,
        504.43536376953125,
        415.21837744140635,
        434.71400610351566
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {}
    }
  ],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.8264462809917354,
      "offset": [
        2479.7573462836767,
        -278.59125579107655
      ]
    },
    "frontendVersion": "1.28.8",
    "VHS_latentpreview": false,
    "VHS_latentpreviewrate": 0,
    "VHS_MetadataImage": true,
    "VHS_KeepIntermediate": true
  },
  "version": 0.4
}