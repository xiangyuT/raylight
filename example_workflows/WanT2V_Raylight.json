{
  "id": "b590dcc4-90de-4786-b0a4-6b9020fb3eb3",
  "revision": 0,
  "last_node_id": 34,
  "last_link_id": 34,
  "nodes": [
    {
      "id": 20,
      "type": "CLIPTextEncode",
      "pos": [
        940,
        750
      ],
      "size": [
        424.6909484863281,
        88
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 17
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            33
          ]
        }
      ],
      "title": "CLIP Text Encode (Positive Prompt)",
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        "色调艳丽，过曝，静态，细节模糊不清，字幕，风格，作品，画作，画面，静止，整体发灰，最差质量，低质量，JPEG压缩残留，丑陋的，残缺的，多余的手指，画得不好的手部，画得不好的脸部，畸形的，毁容的，形态畸形的肢体，手指融合，静止不动的画面，杂乱的背景，三条腿，背景人很多，倒着走"
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 21,
      "type": "VAEDecode",
      "pos": [
        1990,
        340
      ],
      "size": [
        210,
        46
      ],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 23
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 24
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            21
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "VAEDecode"
      },
      "widgets_values": []
    },
    {
      "id": 22,
      "type": "CreateVideo",
      "pos": [
        2230,
        340
      ],
      "size": [
        210,
        78
      ],
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 21
        },
        {
          "name": "audio",
          "shape": 7,
          "type": "AUDIO",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "VIDEO",
          "type": "VIDEO",
          "links": [
            22
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "CreateVideo"
      },
      "widgets_values": [
        16
      ]
    },
    {
      "id": 23,
      "type": "SaveVideo",
      "pos": [
        2010,
        480
      ],
      "size": [
        432.9290466308594,
        453.8443908691406
      ],
      "flags": {},
      "order": 18,
      "mode": 0,
      "inputs": [
        {
          "name": "video",
          "type": "VIDEO",
          "link": 22
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "SaveVideo"
      },
      "widgets_values": [
        "video/ComfyUI",
        "auto",
        "auto"
      ]
    },
    {
      "id": 17,
      "type": "CLIPTextEncode",
      "pos": [
        940,
        610
      ],
      "size": [
        424.6909484863281,
        88
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 15
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            31
          ]
        }
      ],
      "title": "CLIP Text Encode (Positive Prompt)",
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        "a fox moving quickly in a beautiful winter scenery nature trees mountains daytime tracking camera"
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 19,
      "type": "EmptyHunyuanLatentVideo",
      "pos": [
        1392.9451904296875,
        844.8319091796875
      ],
      "size": [
        210.09432983398438,
        130
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "slot_index": 0,
          "links": [
            18
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "EmptyHunyuanLatentVideo"
      },
      "widgets_values": [
        832,
        480,
        33,
        1
      ]
    },
    {
      "id": 24,
      "type": "Note",
      "pos": [
        858.4744873046875,
        139.15330505371094
      ],
      "size": [
        448.1618347167969,
        159.92376708984375
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Ulyssess vs Ring",
      "properties": {},
      "widgets_values": [
        "Why use Ulysses instead of Ring? Ulysses requires less VRAM, but the attention heads must be divisible among the GPUs. For example, Wan has 40 blocks, so the number of GPUs per Ulysses can be 2, 4, 5, 8, 10, or 20.\n\nRing, on the other hand, doesn’t have that restriction since it’s basically like a game of musical chairs—just without removing the chairs. However, the biggest problem with Ring is communication inefficiency and computation overhead"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 25,
      "type": "Note",
      "pos": [
        630,
        140
      ],
      "size": [
        216.27767944335938,
        157.41268920898438
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Rule of thumb",
      "properties": {},
      "widgets_values": [
        "Just jack up more ulysses per number of GPUs, and set ring only 1.\n\nSet FSDP if you like it, but it will hit ram hard and kinda unstable for now"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 27,
      "type": "Note",
      "pos": [
        861.1655883789062,
        -2.2029457092285156
      ],
      "size": [
        439.5958251953125,
        104.018310546875
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "FSDP2",
      "properties": {},
      "widgets_values": [
        "Raylight is using FSDP2 to shard the model across GPUs. Currently, this is the main cause of high RAM usage. I’m still working on implementing Meta Tensors (tensors without data) to reduce RAM usage, but at the moment they are stored in CPU RAM. This is also the slowest part of model loading and the most unstable, since most FSDP2 examples are very sterile and clean, while Comfy’s usage is anything but that."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 28,
      "type": "Note",
      "pos": [
        400.4482727050781,
        0.8481568694114685
      ],
      "size": [
        219.1533203125,
        292.4241943359375
      ],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Introduction",
      "properties": {},
      "widgets_values": [
        "As the name implies, Raylight uses Ray workers, called Actors. Each worker is its own Python process. While this allows splitting across multiple VRAMs, it definitely increases RAM usage. Then again, RAM is much cheaper than VRAM."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 16,
      "type": "VAELoader",
      "pos": [
        1645.53271484375,
        721.1167602539062
      ],
      "size": [
        295.85809326171875,
        61.84592056274414
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "slot_index": 0,
          "links": [
            24
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "VAELoader",
        "models": [
          {
            "name": "wan_2.1_vae.safetensors",
            "url": "https://huggingface.co/Comfy-Org/Wan_2.1_ComfyUI_repackaged/resolve/main/split_files/vae/wan_2.1_vae.safetensors?download=true",
            "directory": "vae"
          }
        ]
      },
      "widgets_values": [
        "Wan2_1_VAE_bf16.safetensors"
      ]
    },
    {
      "id": 15,
      "type": "CLIPLoader",
      "pos": [
        940,
        880
      ],
      "size": [
        429.68731689453125,
        106
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "slot_index": 0,
          "links": [
            15,
            17
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "CLIPLoader",
        "models": [
          {
            "name": "umt5_xxl_fp8_e4m3fn_scaled.safetensors",
            "url": "https://huggingface.co/Comfy-Org/Wan_2.1_ComfyUI_repackaged/resolve/main/split_files/text_encoders/umt5_xxl_fp8_e4m3fn_scaled.safetensors?download=true",
            "directory": "text_encoders"
          }
        ]
      },
      "widgets_values": [
        "umt5_xxl_fp8_e4m3fn_scaled.safetensors",
        "wan",
        "default"
      ]
    },
    {
      "id": 8,
      "type": "RayUNETLoader",
      "pos": [
        954.1246948242188,
        339.85400390625
      ],
      "size": [
        270,
        102
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "ray_actors_init",
          "type": "RAY_ACTORS_INIT",
          "link": 6
        },
        {
          "name": "lora",
          "shape": 7,
          "type": "RAY_LORA",
          "link": 30
        }
      ],
      "outputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "links": [
            14
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayUNETLoader"
      },
      "widgets_values": [
        "wan14.safetensors",
        "default"
      ]
    },
    {
      "id": 1,
      "type": "RayInitializer",
      "pos": [
        621.1966552734375,
        340.9051208496094
      ],
      "size": [
        291.400390625,
        202
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "ray_actors_init",
          "type": "RAY_ACTORS_INIT",
          "links": [
            6
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayInitializer"
      },
      "widgets_values": [
        "local",
        "default",
        2,
        1,
        true,
        false
      ]
    },
    {
      "id": 33,
      "type": "easy cleanGpuUsed",
      "pos": [
        1387.1341552734375,
        527.9064331054688
      ],
      "size": [
        157.38925170898438,
        26
      ],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "name": "anything",
          "type": "*",
          "link": 31
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "*",
          "links": [
            32
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "easy cleanGpuUsed"
      },
      "widgets_values": []
    },
    {
      "id": 34,
      "type": "easy cleanGpuUsed",
      "pos": [
        1389.572021484375,
        651.3615112304688
      ],
      "size": [
        157.38925170898438,
        26
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "anything",
          "type": "*",
          "link": 33
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "*",
          "links": [
            34
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "easy cleanGpuUsed"
      },
      "widgets_values": []
    },
    {
      "id": 14,
      "type": "XFuserKSamplerAdvanced",
      "pos": [
        1640,
        340
      ],
      "size": [
        304.748046875,
        334
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "ray_actors",
          "type": "RAY_ACTORS",
          "link": 14
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 32
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 34
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 18
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            23
          ]
        },
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": null
        },
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": null
        },
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": null
        }
      ],
      "properties": {
        "Node name for S&R": "XFuserKSamplerAdvanced"
      },
      "widgets_values": [
        "enable",
        823953663379817,
        "randomize",
        4,
        1,
        "uni_pc",
        "simple",
        0,
        10000,
        "disable"
      ]
    },
    {
      "id": 31,
      "type": "RayLoraLoader",
      "pos": [
        622.13916015625,
        600.903564453125
      ],
      "size": [
        270,
        82
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "prev_ray_lora",
          "shape": 7,
          "type": "RAY_LORA",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "ray_lora",
          "type": "RAY_LORA",
          "links": [
            30
          ]
        }
      ],
      "properties": {
        "Node name for S&R": "RayLoraLoader"
      },
      "widgets_values": [
        "lx14.safetensors",
        1
      ]
    },
    {
      "id": 26,
      "type": "Note",
      "pos": [
        632.332275390625,
        -2.2029402256011963
      ],
      "size": [
        213.0511016845703,
        102.49275970458984
      ],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Glosarry",
      "properties": {},
      "widgets_values": [
        "rank = id assigned to the GPU\nworld_size = number of GPUs\n\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    }
  ],
  "links": [
    [
      6,
      1,
      0,
      8,
      0,
      "RAY_ACTORS_INIT"
    ],
    [
      14,
      8,
      0,
      14,
      0,
      "RAY_ACTORS"
    ],
    [
      15,
      15,
      0,
      17,
      0,
      "CLIP"
    ],
    [
      17,
      15,
      0,
      20,
      0,
      "CLIP"
    ],
    [
      18,
      19,
      0,
      14,
      3,
      "LATENT"
    ],
    [
      21,
      21,
      0,
      22,
      0,
      "IMAGE"
    ],
    [
      22,
      22,
      0,
      23,
      0,
      "VIDEO"
    ],
    [
      23,
      14,
      0,
      21,
      0,
      "LATENT"
    ],
    [
      24,
      16,
      0,
      21,
      1,
      "VAE"
    ],
    [
      30,
      31,
      0,
      8,
      1,
      "RAY_LORA"
    ],
    [
      31,
      17,
      0,
      33,
      0,
      "*"
    ],
    [
      32,
      33,
      0,
      14,
      1,
      "CONDITIONING"
    ],
    [
      33,
      20,
      0,
      34,
      0,
      "*"
    ],
    [
      34,
      34,
      0,
      14,
      2,
      "CONDITIONING"
    ]
  ],
  "groups": [],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.8954302432552405,
      "offset": [
        -703.8326839919522,
        -226.500541955868
      ]
    },
    "frontendVersion": "1.25.9"
  },
  "version": 0.4
}